# SILAM Pollen

Интеграция для Home Assistant, получающая данные о пыльце с сервера SILAM в формате XML.

## Описание

Интеграция **SILAM Pollen** предоставляет сенсор, который динамически формирует URL для запроса данных о пыльце. Данные запрашиваются с сервера SILAM с помощью HTTP-запроса, затем парсятся из XML и обновляются в Home Assistant.

## Установка

### Ручная установка

1. Скопируйте папку `silam_pollen` в каталог `custom_components` вашей конфигурации Home Assistant.
2. Перезапустите Home Assistant.
3. Добавьте интеграцию через веб-интерфейс:
   - Перейдите в **Настройки → Интеграции**.
   - Нажмите **Добавить интеграцию** и выберите **SILAM Pollen**.
   - Заполните необходимые поля (например, имя, URL-шаблон, координаты, высоту, выбор переменной, интервал опроса).

### Установка через HACS

1. Убедитесь, что репозиторий [danishru/silam_pollen](https://github.com/danishru/silam_pollen) публичный и содержит файл `hacs.json` в корне (на одном уровне с папкой `custom_components`).
2. Создайте релиз (например, `v0.1-beta`).
3. В Home Assistant перейдите в раздел **HACS → Интеграции**.
4. Нажмите **Добавить пользовательский репозиторий** и введите URL вашего репозитория (например, `https://github.com/danishru/silam_pollen`).
5. Выберите тип репозитория **Integration** и нажмите **Добавить**.
6. Перезагрузите Home Assistant – ваша интеграция появится в списке доступных для установки через HACS.

## Конфигурация

При настройке интеграции через веб-интерфейс (config flow) доступны следующие параметры:

- **Имя** – название интеграции.
- **data_url** – шаблон URL для запроса данных (по умолчанию задан).
- **Ручное задание координат** – если включено, используются указанные значения **latitude** и **longitude**; иначе берутся координаты из состояния зоны `zone.home`.
- **altitude** – высота (vertCoord), по умолчанию 275.
- **var** – выбор переменной (например, "cnc_POLLEN_ALDER_m22" для ольхи, "cnc_POLLEN_BIRCH_m22" для берёзы, "cnc_POLLEN_Grass_m22" для травы, "cnc_POLLEN_Ragweed_m22" для амброзии).
- **update_interval** – интервал опроса в минутах (по умолчанию 5).

## Использование

После установки интеграции в Home Assistant создается сенсор, который автоматически обновляет данные с сервера SILAM через заданные интервалы. Значение сенсора соответствует значению из XML-блока, например:

```xml
<data name="cnc_POLLEN_BIRCH_m22" units="number/m3">1.4988473E-9</data>
```

## Лицензия

[MIT License](LICENSE)

## Поддержка

Если возникнут вопросы или проблемы, создайте issue в [репозитории](https://github.com/danishru/silam_pollen/issues).
