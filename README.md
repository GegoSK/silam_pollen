# SILAM Pollen

Интеграция для Home Assistant, получающая данные о пыльце с сервера SILAM в формате XML.

## Описание

Интеграция **SILAM Pollen** предоставляет сенсор, который динамически формирует URL для запроса данных о пыльце. Данные запрашиваются с сервера SILAM с помощью HTTP-запроса, затем парсятся из XML и обновляются в Home Assistant.

## Установка

### Ручная установка

1. Скопируйте папку `silam_pollen` в каталог `custom_components` вашей конфигурации Home Assistant.
2. Перезапустите Home Assistant.
3. Добавьте интеграцию через веб-интерфейс:
   - Перейдите в **Настройки → Интеграции**.
   - Нажмите **Добавить интеграцию** и выберите **SILAM Pollen**.
   - Заполните необходимые поля (например, имя, URL-шаблон, координаты, высоту, выбор переменной, интервал опроса).

### Инструкция по добавлению интеграции через HACS

Следуйте этим шагам, чтобы добавить интеграцию **SILAM Pollen** через HACS:

1. **Убедитесь, что HACS установлен:**
   - Если HACS ещё не установлен, следуйте [официальной инструкции по установке HACS](https://hacs.xyz/docs/installation/installation).

2. **Откройте Home Assistant и перейдите в HACS:**
   - На боковой панели найдите и нажмите на значок HACS.

3. **Добавление пользовательского репозитория:**
   - В HACS перейдите на вкладку **Интеграции**.
   - Нажмите кнопку **Добавить пользовательский репозиторий** (Custom Repositories).
   - В появившемся окне введите URL репозитория:  
     `https://github.com/danishru/silam_pollen`
   - Выберите тип репозитория **Integration**.
   - Нажмите **Добавить**.

4. **Установка интеграции:**
   - После добавления репозитория HACS автоматически обнаружит релиз вашей интеграции.
   - В разделе **Интеграции** HACS появится интеграция с именем, указанным в файле `hacs.json` (например, **SILAM Pollen**).
   - Найдите интеграцию и нажмите **Установить**.
   - Дождитесь завершения установки.

5. **Настройка интеграции:**
   - После установки перейдите в **Настройки → Интеграции** Home Assistant.
   - Найдите **SILAM Pollen** и следуйте инструкциям мастера настройки для ввода параметров (например, URL-шаблон, координаты, высоту, выбор переменной и интервал опроса).

Теперь ваша интеграция установлена и готова к использованию через HACS!

## Конфигурация

При настройке интеграции через веб-интерфейс (config flow) доступны следующие параметры:

- **Имя** – название интеграции.
- **data_url** – шаблон URL для запроса данных (по умолчанию задан).
- **Ручное задание координат** – если включено, используются указанные значения **latitude** и **longitude**; иначе берутся координаты из состояния зоны `zone.home`.
- **altitude** – высота (vertCoord), по умолчанию 275.
- **var** – выбор переменной (например, "cnc_POLLEN_ALDER_m22" для ольхи, "cnc_POLLEN_BIRCH_m22" для берёзы, "cnc_POLLEN_Grass_m22" для травы, "cnc_POLLEN_Ragweed_m22" для амброзии).
- **update_interval** – интервал опроса в минутах (по умолчанию 5).

## Использование

После установки интеграции в Home Assistant создается сенсор, который автоматически обновляет данные с сервера SILAM через заданные интервалы. Значение сенсора соответствует значению из XML-блока, например:

```xml
<data name="cnc_POLLEN_BIRCH_m22" units="number/m3">1.4988473E-9</data>
```

## Лицензия

[MIT License](LICENSE)

## Поддержка

Если возникнут вопросы или проблемы, создайте issue в [репозитории](https://github.com/danishru/silam_pollen/issues).
